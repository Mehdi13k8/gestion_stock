{% extends 'flexible/base1.html' %}
 {% load crispy_forms_tags %}

    {% block content3 %}
    {% load staticfiles %}


 {% if entrepots %}
  

{% for entrepot in entrepots %}
    <p><b>entrepôt {{entrepot.designation}}</b> {{entrepot.adresse}}</p>
    
    {% endfor %}
{% endif %}


  {% if autres %}
{% for autre in autres %}
    <p><b>{{autre.nom}}</b> {{autre.adresse}}</p>
    
    
    {% endfor %}
{% endif %}
{% if departs %}
{% for depart in departs %}
    <p><b> {{depart.transporteur.user.nom}}</b> départ: {{depart.depart}} arrivé: {{depart.arrive}}</p>
    
    
    {% endfor %}
{% endif %}

   

{% endblock %}
{% block content4 %}
 
    <h3 class="mb-3">Les Recommandations</h3>
  <div class="row content">
    
    
    <div class="col-sm-4 ">
     
          

     
<table class="table  table-striped ">
      <thead>
        <tr>
          <th>Partenaire</th>
          
          
          <th>score</th>
          
          
        
        </tr>
      </thead>
      <tbody>
        
         {% for cal in calcul %}
          <tr>
            <td class="align-middle">
             {{cal.partenaire__user__nom }}</td>
           
           
            <td class="align-middle">{{ cal.c }} <img src=" {{ MEDIA_URL }}etoile.png" height="15" width="15" /> </td>
            
            
            
           
          </tr>
          

        {% empty %}
          <tr>
            <td class="bg-light text-center font-italic" colspan="4">aucun favori</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>





 
    <div class="col-sm-4 ">


    
      <table class="table  table-striped ">
      <thead>
        <tr>
          <th>Entrepot</th>
          
          
          <th>score</th>
          
          
        
        </tr>
      </thead>
      <tbody>
        
         {% for cal in calcul3 %}
          <tr>
            <td class="align-middle">
            {{cal.entrepot__designation }}</td>
           
            
            <td class="align-middle">{{ cal.c }} <img src=" {{ MEDIA_URL }}etoile.png" height="15" width="15" /> </td>
            
            
            
           
          </tr>
          

        {% empty %}
          <tr>
            <td class="bg-light text-center font-italic" colspan="4">aucun favori</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>
     

    <div class="col-sm-4 ">


    
      <table class="table  table-striped ">
      <thead>
        <tr>
          <th>Transporteur</th>
          
          
          <th>score</th>
          
          
        
        </tr>
      </thead>
      <tbody>
        
         {% for cal in calcul2 %}
          <tr>
            <td class="align-middle">
            {{cal.transporteur__user__nom }}</td>
           
            
            <td class="align-middle">{{ cal.c }} <img src=" {{ MEDIA_URL }}etoile.png" height="15" width="15" /> </td>
            
            
            
           
          </tr>
          

        {% empty %}
          <tr>
            <td class="bg-light text-center font-italic" colspan="4">aucun favori</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>
   

  </div>
 {% if entsProches %} 
 <h3 class="mb-3">Les entrepôts proches </h3>
  <table class="table table-striped table-wrapper-scroll-y my-custom-scrollbar">
      
      <tbody>
        {% for entrepot in entsProches %}
          <tr>
            
            <td class="align-middle"><b>{{ entrepot.designation }}</b></td>
            <td class="align-middle">{{ entrepot.partenaireProp }}</td>
            <td class="align-middle">{{ entrepot.specificite }}</td>
            <td class="align-middle">{{ entrepot.capacite }}</td>
            <td class="align-middle">{{ entrepot.adresse }}</td>
            <td class="align-middle">{{ entrepot.distance.km|floatformat }}km</td>
            <td class="align-middle"><img src="{{ MEDIA_URL }}{{ entrepot.photo }}"  height="180" width="240" /> </td>
           
           
          </tr>
          
        
        {% empty %}
          <tr>
            <td class="bg-light text-center font-italic" colspan="4">Indisponible pour le moment.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    {% endif %}
</br>

{% if transProches %} 
 <h3 class="mb-3">Les entrepôts proches </h3>
  <table class="table table-striped table-wrapper-scroll-y my-custom-scrollbar">
      
      <tbody>
        {% for transp in transProches %}
          <tr>
           
            <td class="align-middle"><b>Transporteur {{ transp.user.nom }}</b></td> 
            <td class="align-middle"> {{ transp.user.adresse }}</td> 
            <td class="align-middle"> à  {{ transp.distance.km|floatformat }}km</td>
            
           
          </tr>
          
        
        {% empty %}
          <tr>
            <td class="bg-light text-center font-italic" colspan="4">Indisponible pour le moment.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    {% endif %}

{% endblock %}
 {% block content %}


</br>
<h3 class="mb-3">Mes offres Mensuelles </h3>
<a href="{% url 'offreL_ajout' %}" class="btn btn-info " role="button" style="width: 35%;">Ecrire une offre</a>


<a href="{% url 'offreLiv_ajout' %}" class="btn btn-success " role="button" style="width: 35%;">Envoyer une offre au partenaire</a></br>


 <table class=" table  table-striped table-wrapper-scroll-y my-custom-scrollbar ">
      <thead>
        <tr>
          <th>designation</th>
          <th>partenaire</th>
          <th>produit</th>
          <th>entrepot</th>
          <th>categorie</th>
           <th>quantité</th>
            <th>date arrivée</th>
          <th>Date</th>
          <th>Prix estimé</th>
          <th>Réponse</th>
        
        </tr>
      </thead>
      <tbody >
        {% for offre in homeC %}
          <tr>
            <td class="align-middle">
             <a href="{% url 'nouvelleOffre' offre.pk %}" class="btn btn-primary">{{offre.offre.designation }}</a></td>
            <td class="align-middle">{{ offre.partenaire }}</td>
            <td class="align-middle">{{ offre.offre.produit.designation }}</td>
            <td class="align-middle">{{ offre.entrepot }}</td>
            <td class="align-middle">{{ offre.offre.categorie }}</td>
            <td class="align-middle">{{ offre.offre.quantité }}</td>
            <td class="align-middle">{{ offre.offre.datearrive }}</td>
            <td class="align-middle">{{ offre.Date }}</td>
            <td class="align-middle">{% for tarif in tarifs %}{% if tarif.nb_palettes == offre.quantité and tarif.entrepot == offre.entrepot  %}
             

              {{ tarif.prixFinal }}€
            {% endif %} {% endfor %}</td>
            <td class="align-middle">{% for reponse in reponses %}

              {% if reponse.offre.offre.designation == offre.offre.designation  and reponse.partenaire == offre.partenaire  %} 
                 {% if  reponse.is_accepted %}   <img src=" {{ MEDIA_URL }}photos/yes.png" height="19" width="19" /> 
                 {% elif not reponse.is_accepted   %}  <img src=" {{ MEDIA_URL }}photos/non.png" height="19" width="19" />
              
             
                 {% endif %} 
              
            {% endif %} {% endfor %} </td>
           
            <td class="text-right">
            
            </td>
          </tr>
          

        {% empty %}
          <tr>
            <td class="bg-light text-center font-italic" colspan="4">aucune offre</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

</br></br>
    <h3 class="mb-3">Mes offres de transport  </h3>
<a href="{% url 'offreT_ajout' %}" class="btn btn-info " role="button" style="width: 35% ; ">Ecrire une offre de Transport</a>
<a href="{% url 'offretra_ajout' %}" class="btn btn-success " role="button" style="width: 35%;">Envoyer une offre au Transporteur</a>
 
 <table class=" table  table-striped table-wrapper-scroll-y my-custom-scrollbar ">
      <thead>
        <tr>
          <th>designation</th>
          
          <th>refproduit</th>
          <th>categorie</th>
          <th>transporteur</th>
           <th>quantité</th>
            <th>depart</th>
          <th>arrive</th>
          <th>date</th>
          <th>Prix estimé</th>
           <th>Réponse</th>
        </tr>
      </thead>
      <tbody>
        {% for offret in offresT %}
          <tr>
            <td class="align-middle">
             <a href="" class="btn btn-primary">{{offret.offre.designation }}</a></td>
            <td class="align-middle">{{ offret.offre.produit.refproduit }}</td>
            <td class="align-middle">{{ offret.offre.categorie }}</td>
            <td class="align-middle">{{ offret.transporteur }}</td>
            
            <td class="align-middle">{{ offret.offre.quantité }}</td>
            <td class="align-middle">{{ offret.offre.depart }}</td>
            <td class="align-middle">{{ offret.offre.arrive }}</td>
            <td class="align-middle">{{offret.date}}</td>
            <td class="align-middle">{% for tarif2 in tarifsT %}

              {% if tarif2.depart == offret.offre.depart and tarif2.arrive == offret.offre.arrive  and tarif2.transporteur == offret.transporteur and tarif2.nb_palettes == offret.quantité %} 
               
             

              {{ tarif2.prixFinalT}}€
              
            {% endif %} {% endfor %}</td>

             <td class="align-middle">{% for reponse in reponsesT %}

              {% if reponse.offre.offre.designation == offret.designation  and reponse.partenaire == offret.partenaire  %} 
              {% if  reponse.is_accepted %}   <img src=" {{ MEDIA_URL }}photos/yes.png" height="19" width="19" />{% endif %}
              {% if not reponse.is_accepted   %}  <img src=" {{ MEDIA_URL }}photos/non.png" height="19" width="19" />
              
             

             {% endif %}
              
            {% endif %} {% endfor %} </td>
            <td class="text-right">
            
            </td>
          </tr>
          

        {% empty %}
          <tr>
            <td class="bg-light text-center font-italic" colspan="4">aucune offre</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>


   

             
                  <a href="" class="btn btn-success"><img src=" {{ MEDIA_URL }}photos/bl.png" height="50" width="50" /> Envoyer les documents </a> 
                
                 
      
        
    

 

{% endblock %}


{% block content2 %}

<div class="list-group">
   {% for message in messages %}
  <a href="#" class="list-group-item list-group-item-action flex-column align-items-start active">
    <div class="d-flex w-100 justify-content-between">
       <img src=" {{ MEDIA_URL }}msg.png" width="35"  heigth="35"/> 
      <h4 class="mb-1">admin</h4>
      <small> {{ message.Date }}</small>
    </div>
    <p class="mb-1">{{ message.text }}</small>
  </a>
 {% empty %}
          <tr>
            <td class="bg-light text-center font-italic" colspan="4">Vous n'avez aucun message.</td>
          </tr>
        {% endfor %}
</div>
{% endblock %} 